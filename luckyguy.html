<!DOCTYPE html>
<html>
<head>
    <title>RandomSelect</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 引用Bootstrap的CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- 引用Font Awesome的CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <!-- 引用jQuery的CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
        }

        textarea, label, input, button {
            margin: 10px;
        }

        button.blink {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
        }

        button.blink:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <div class="container">
        <main role="main" class="pb-3"></main>

        <h2 class="mb-3">隨機抽出機車車位，未選上同仁</h2>
        <p class="">輸入候選名單，並以逗號(,)分隔</p>
        <textarea id="names" rows="10" cols="50" placeholder="輸入名字，以逗號分隔"></textarea>
        <br>
        <label for="count">輸入抽選數量:</label>
        <input type="number" id="count">
        <button id="selectButton" class="btn btn-primary">執行</button>
        <button class="btn btn-success blink" id="blinkButton">名單</button>
        <div id="result"></div>
    </div>

    <script>
        var animationInterval;
        var isBlinking = false;
        var namesToBlink = [];
        var excludedNames = ["cherie", "王瑞雯", "cherie.wang", "王瑞雯", "廖婉如", "Cony.Liao"];

        // 指向隨機選擇名字的函數
        function selectRandomNames() {
            var namesTextArea = document.getElementById("names");
            var countInput = document.getElementById("count");
            var resultDiv = document.getElementById("result");

            var inputNames = namesTextArea.value;
            var splitCharacters = [",", ";", "。", "，"];
            var splitRegex = new RegExp("[" + splitCharacters.join("") + "]+", "g");
            var names = inputNames.split(splitRegex).map(name => name.trim().toLowerCase());

            startBlinking(names, names.length);
        }

        document.getElementById("selectButton").addEventListener("click", selectRandomNames);

        document.getElementById("blinkButton").addEventListener("click", selectRandomNames);

        function startBlinking(names, numToBlink) {
            var blinkCount = 3; // 閃爍輪數
            var round = 0;

            if (!isBlinking) {
                isBlinking = true;
                document.getElementById("blinkButton").textContent = "停止閃爍";

                namesToBlink = names.filter(name => !excludedNames.map(name => name.toLowerCase()).includes(name)).slice(0); // 複製並排除名字
                animationInterval = setInterval(function () {
                    if (round < blinkCount) {
                        if (namesToBlink.length > 0) {
                            document.getElementById("result").textContent = namesToBlink.shift();
                        } else {
                            round++;
                            namesToBlink = names.filter(name => !excludedNames.map(name => name.toLowerCase()).includes(name)).slice(0); // 重新開始動畫
                        }
                    } else {
                        stopBlinking();
                    }
                }, 10000); // 每10秒閃爍一次
            } else {
                stopBlinking();
            }
        }

        function stopBlinking() {
            clearInterval(animationInterval);
            document.getElementById("result").textContent = "閃爍停止";
            document.getElementById("blinkButton").textContent = "閃爍名字";
            isBlinking = false;
        }
    </script>
    <script>
        // 自動執行選取名字
        selectRandomNames();
    </script>
</body>
</html>
